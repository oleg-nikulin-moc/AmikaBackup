function validateForm(){const e=document.getElementsByClassName("tab"),t=e[currentTab].querySelectorAll("[required]"),n=document.getElementById("password"),a=document.getElementById("confirmPassword"),o=document.getElementById("confirmPasswordError"),s=document.getElementById("passwordError");let l=!0;const i=document.querySelector("[data-terms-field]"),r=document.getElementById("submitBtn"),d=(document.getElementById("nextBtn"),document.getElementById("salon_name"),document.getElementById("salonNameError"),document.getElementById("phone")),c=document.getElementById("phoneError");let u=d.value.trim();const m=e[currentTab].querySelector("#account_number"),p=document.querySelector("#account_number"),y=document.getElementById("accountNumberError");let g=p.value.trim();const v=document.getElementById("emailMain"),f=document.getElementById("emailError");let h=v.value;const E=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,b=e[currentTab].querySelector("#zip"),S=document.getElementById("zip"),w=document.getElementById("zipError");let x=v.value;const I=/^[a-zA-Z0-9]{8,50}$/;function B(){var e;l=!0,t.forEach((function(e){""===e.value?(e.classList.add("invalid"),l=!1,e.nextElementSibling.textContent="Empty value"):e.value.length<2?(e.classList.add("invalid"),l=!1,e.nextElementSibling.textContent="Text must be at least 2 characters"):(e.classList.remove("invalid"),e.nextElementSibling.textContent="")})),""===u||validatePhoneNumber(u)?(c.style.display="none",c.textContent="",d.classList.remove("invalid")):(c.style.display="block",c.textContent="Incorrect phone number",d.classList.add("invalid"),l=!1),E.test(h)?(f.textContent="",f.style.display="none",v.classList.remove("invalid")):(f.textContent="Invalid email format",f.style.display="block",v.classList.add("invalid"),l=!1),I.test(n.value)?n.value!==a.value?(o.textContent="Passwords do not match",l=!1):(s.textContent="",o.textContent=""):(s.textContent="Password must be at least 8 characters",l=!1),!0===b&&("/^(d{3})sd{3}-d{4}$/".test(e=x)||"/^(+?1s?)?(()?(d{3})(?(2)))[-.s]?(d{3})[-.s]?(d{4})$/".test(e)?(w.textContent="",w.style.display="none",S.classList.remove("invalid")):(w.textContent="Invalid zip code format",w.style.display="block",S.classList.add("invalid"),l=!1)),!0===m&&(!function(e){return"/^d{3,50}$/".test(e)}(g)?(y.style.display="block",y.textContent="Incorrect phone number",p.classList.add("invalid"),l=!1):(y.style.display="none",y.textContent="",p.classList.remove("invalid")))}function C(e){const t=e.target,n=t.getAttribute("id");"email"===n?h=t.value:"phone"===n?u=t.value:"account_number"===n?g=t.value:"zip"===n&&(x=t.value),B()}return i.addEventListener("change",(function(){i.checked&&l?r.disabled=!1:r.disabled=!0})),t.forEach((function(e){e.addEventListener("input",C)})),v.addEventListener("input",C),d.addEventListener("input",C),p.addEventListener("input",C),n.addEventListener("input",C),a.addEventListener("input",C),i.addEventListener("change",B),S.addEventListener("change",B),B(),l}function validatePhoneNumber(e){return/^\d{10}$/.test(e)}function imagePreview(){const e=document.getElementById("file-input"),t=document.querySelector("[data-upload-text]"),n=document.querySelector("[data-remove-img]"),a=document.querySelector("[data-upload-file]"),o=document.querySelector("[ data-upload-image-wrap]"),s=t.textContent,l=document.getElementById("preview"),i=e.files[0];if(i&&i.size>5242880&&(alert("Розмір файлу перевищує максимально допустимий розмір (5 МБ). Будь ласка, виберіть файл меншого розміру."),e.value=""),["image/jpeg","image/jpg","application/pdf","image/png"].includes(i.type)){const r=e.value.split("\\").pop();if(r)if(t.textContent=r,n.style.display="flex",l.style.display="block","application/pdf"===i.type)o.style.display="none",a.style.display="none";else{const e=new FileReader;e.onload=e=>{l.setAttribute("src",e.target.result),a.style.display="none",o.style.display="block"},e.readAsDataURL(i)}else t.textContent=s,n.style.display="none",l.style.display="none",a.style.display="block"}}function removePreview(){const e=document.getElementById("file-input").files[0],t=document.querySelector("[data-upload-text]"),n=document.querySelector("[data-remove-img]"),a=document.querySelector("[data-upload-file]"),o=document.getElementById("preview"),s=t.textContent;e.value="",t.textContent=s,n.style.display="none",o.style.display="none",a.style.display="block"}function toggleDivVisibility(){const e=document.querySelectorAll("[data-upload-image]")[0],t=document.querySelectorAll("[data-upload-image-block]")[0],n=e.value;t.style.display="true"===n?"block":"none"}function showSpinner(){const e=document.querySelector("[data-spinner-wrap]");document.querySelectorAll(".tingle-modal-box").forEach((e=>e.style.overflow="hidden")),e.style.display="block"}function hideSpinner(){const e=document.querySelector("[data-spinner-wrap]");document.querySelectorAll(".tingle-modal-box").forEach((e=>e.style.overflow="auto")),e.style.display="none"}function formResize(e){document.querySelectorAll(".ac-popup").forEach((t=>{"lg"===e?(t.classList.add("ac-popup--lg"),t.classList.remove("ac-popup--sm")):"sm"===e?(t.classList.add("ac-popup--sm"),t.classList.remove("ac-popup--lg")):(t.classList.add("ac-popup--md"),t.classList.remove("ac-popup--lg"),t.classList.remove("ac-popup--sm"))}))}document.addEventListener("DOMContentLoaded",(e=>{document.getElementById("country");const t=document.getElementById("state"),n=document.getElementById("city"),a=document.getElementById("zip"),o={usa:["Select State","Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"],canada:["Select State","Alberta","British Columbia","Manitoba","New Brunswick","Newfoundland and Labrador","Northwest Territories","Nova Scotia","Nunavut","Ontario","Prince Edward Island","Quebec","Saskatchewan","Yukon"]};n.disabled=!0,a.disabled=!0,function(e){if(t.innerHTML="",e in o){for(let n=0;n<o[e].length;n++){let a=document.createElement("option");a.value=o[e][n],a.text=o[e][n],t.appendChild(a)}t.disabled=!1}else t.disabled=!0}("usa"),t.addEventListener("change",(()=>{n.disabled=!1,a.disabled=!1}))}));const secretCode="32kMURYG2ryEG5n4UEgzeaMpzpKMcoxJBNkvSiA2";function generateAuthData(e){return toBase64(JSON.stringify(e))}function generateToken(e,t){const n=generateSecretSalt(e,t),a=toBase64(JSON.stringify(e))+n,o=CryptoJS.SHA256(a);return toBase64(CryptoJS.enc.Hex.stringify(o))}function generateSecretSalt(e,t){return toBase64(e.customer.email+"/"+t)}function toBase64(e){return btoa(decodeURIComponent(encodeURIComponent(e)))}function submitForm(e){const t=document.getElementById("create_customer");e.preventDefault();const n=document.getElementById("file-input"),a=t.phone.value.trim().replace(/-/g,"");let o="";o=""!==a?"+1"+a:a;const s={customer:{first_name:t.firstName.value,last_name:t.last_name.value,email:t.email.value,account_number:t.account_number.value.replace(/-/g,""),password:t.password.value,password_confirmation:t.confirmPassword.value,phone:o,salon_name:t.salon_name.value,distributor_name:t.distributorName.value,distributor_email:t.email.value,is_suit:t.isSuit.value,addresses:[{salon_address:t.salon_address.value,country:t.country.value.toUpperCase(),state:t.province.value,city:t.city.value,zip:t.zip.value}]}},l=generateToken(s,secretCode),i=generateAuthData(s);showSpinner(),fetch(`https://3m3119r1fj.execute-api.us-east-1.amazonaws.com/development/registration?auth_data=${i}`,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":l},body:JSON.stringify(s)}).then((e=>e.json())).then((e=>{if(e.success){if(n.files.length>0){const e=n.files[0],a=e.name.replace(/[\/+&\\]/g,"_"),o=btoa(t.email)+"&"+a;return fetch(`https://dfx7dgn178.execute-api.us-east-1.amazonaws.com/development/amika-file-upload-stage/${o}?auth_data=${i}`,{method:"POST","x-api-key":l,headers:{"Content-Type":"multipart/form-data"},body:e}).then((function(e){200===e.status?(console.log("Response success"),window.showSuccessForm(),hideSpinner()):alert("Image not uploaded.")})).catch((function(e){console.error("Error:",e)}))}if(e.success)return console.log("If successful but image loading is not required, perform the necessary actions."),window.showSuccessForm(),hideSpinner(),Promise.resolve();console.log("fieldName",e.errors[0].field_name),console.log("error_message",e.errors[0].error_message),hideSpinner(),window.hideRecoverPasswordForm(),hideSpinner(),console.log("Form submitted successfully")}else{console.log("Form submission error:",e.error_message),hideSpinner();const t=e.errors;console.log("responseErrors",t),t.forEach((function(e){const t=e.field_name,n=e.error_message;if("email"==t){window.nextPrev(-2);const e=document.getElementById("email"),t=document.getElementById("emailError");e.classList.add("invalid"),t.style.display="block",t.textContent=n}else if("account_number"==t){const e=document.getElementById("account_number"),t=document.getElementById("accountNumberError");e.classList.add("invalid"),t.style.display="block",t.textContent=n}else{window.nextPrev(-2);const e=document.getElementById(t),a=document.getElementById(`${t}Error`);e.classList.add("invalid"),a.style.display="block",a.textContent=n}}))}})).catch((e=>{hideSpinner(),console.log(e)}))}